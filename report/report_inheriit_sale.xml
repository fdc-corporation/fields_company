<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<template id="template_sale_id" name="template_sale_name" inherit_id="sale.report_saleorder_document">
		<xpath expr="//t[@t-call='web.external_layout']" position="replace">
			<t t-call="web.external_layout">
				<t t-set="doc" t-value="doc.with_context(lang=doc.partner_id.lang)" />
				<t t-set="forced_vat" t-value="doc.fiscal_position_id.foreign_vat" />
				<div class="page">
					<div class="oe_structure" />
					<h3 class="mt-4" style="color:black;text-align:center;font-weight: 800;margin-bottom:-2px;letter-spacing:3px;">
						<span t-if="env.context.get('proforma', False) or is_pro_forma">
							Pro-Forma Invoice
						</span>
						<span t-elif="doc.state in ['draft','sent']">
							Cotización
						</span>
						<span t-else="">
							Orden de venta
						</span>
					</h3>
					<h3 style="color:black;text-align:center;font-weight: 800;margin-bottom:20px;" t-field="doc.name" />
					<div class="row mb-4" id="informations">
						<table class="table table-sm" style=" border:0px !important;font-size: 12px;">
							<tbody style="border:0px !important;">
								<tr style="border:0px !important;">
									<td class="col-4" style="border:0px !important;">
										<div name="informations_reference" />
										<strong>
											Datos del Cliente
											<span style="color:#E31E24;">
												(*)
											</span>
										</strong>
										<br />
										Cliente:
										<span t-field="doc.partner_id" />
									</td>
									<td class="col-4" style="border:0px !important;">
										<br />
										Direccion:
										<span t-field="doc.partner_id.street" />
									</td>
									<td class="col-3" colspan="1" style="border:0px !important;">
										<br />
										RUC:
										<span t-field="doc.partner_id.vat" />
									</td>
								</tr>
								<tr style="border:0px !important; ">
									<td class="col-4" style="border:0px !important;">
										<strong>
											Datos de Cotizacion
											<span style="color:#E31E24;">
												(*)
											</span>
										</strong>
										<br />
										Fecha de cotización :
										<div name="informations_date">
											<span class="m-0" t-field="doc.date_order" t-options="{&quot;widget&quot;: &quot;date&quot;}">
												2023-12-31
											</span>
										</div>
									</td>
									<td class="col-4" style="border:0px !important;">
										<br />
										Vencimiento:
										<div name="expiration_date">
											<span t-field="doc.validity_date" />
										</div>
									</td>
									<td class="col-3" colspan="1" style="border:0px !important;">
										<br />
										Moneda:
										<span t-field="doc.currency_id" />
									</td>
								</tr>
								<tr style="border:0px !important;">
									<td class="col-4" style="border:0px !important;">
										Condiciones de Pago:
										<span t-field="doc.payment_term_id" />
									</td>
									<td class="col-4" colspan="2" style="border:0px !important;">
										Direccion de entrega:
										<span t-field="doc.partner_shipping_id" />
									</td>
									<!-- <td class="col-4" style="border:0px !important;"> -->
									<!-- Tiempo de Entrega: -->
									<!-- <span t-field="doc.picking_policy"/> -->
									<!-- </td> -->
								</tr>
								<tr style="border:0px !important;">
									<td class="col-4" style="border:0px !important;">
										<strong>
											Datos del Vendedor
											<span style="color:#E31E24;">
												(*)
											</span>
										</strong>
										<br />
										Vendedor :
										<span class="m-0" t-field="doc.user_id" />
									</td>
									<td class="col-5" style="border:0px !important;">
										<br />
										Compañia:
										<span t-field="doc.company_id" />
									</td>
									<td class="col-3" style="border:0px !important;">
										<br />
										Celular:
										<span t-field="doc.user_id.phone" />
									</td>
								</tr>
							</tbody>
						</table>
					</div>
					<h5 class="text-bold text-center">
						<t t-esc="doc.titulo_cotizacion" />
					</h5>
					<!-- Is there a discount on at least one line? -->
					<t t-set="lines_to_report" t-value="doc._get_order_lines_to_report()" />
					<t t-set="display_discount" t-value="any(l.discount for l in lines_to_report)" />
					<!-- Hide taxes AND show taxed amounts on lines -->
					<t t-set="hide_taxes_details" t-value="False" />
					<t t-set="display_taxes" t-value="not hide_taxes_details and any(l._has_taxes() for l in lines_to_report)" />
					<t t-set="index" t-value="0" />
					<div class="oe_structure" />
					<table class="o_has_total_table table o_main_table table-borderless" style="font-size:12px !important;">
						<!-- In case we want to repeat the header, remove "display: table-row-group" -->
						<thead style="display: table-row-group">
                        <tr>
                            <th>
									N°
								</th>
                            <th name="th_description" class="text-start">
									Descripción
								</th>
                            <th t-if="doc.mostrar_img_producto" name="th_img" class="text-center">
									Img. Ref
								</th>
                            <th name="th_quantity" class="text-end text-nowrap">
									Cantidad
								</th>
                            <th name="th_priceunit" class="text-end text-nowrap">
									Precio unitario
								</th>
                            <th name="th_discount" t-if="doc.mostrar_descuento" class="text-end">
                                <span>
										Desc.%
									</span>
                            </th>
                            <th name="th_taxes" t-if="display_taxes" class="text-end">
                                <span>
										Impuestos
									</span>
                            </th>
                            <th name="th_subtotal" class="text-end">
                                <span>
										Sub total
									</span>
                            </th>
                        </tr>
                    </thead>
						<tbody class="sale_tbody">
							<t t-set="current_section" t-value="None" />
							<t t-set="current_subsection" t-value="None" />
							<t t-set="price_field" t-value="'price_total' if hide_taxes_details else 'price_subtotal'" />
							<t t-foreach="lines_to_report" t-as="line">
								<t t-set="is_note" t-value="line.display_type == 'line_note'" />
								<t t-set="is_section" t-value="line.display_type == 'line_section'" />
								<t t-set="is_subsection" t-value="line.display_type == 'line_subsection'" />
								<t t-set="is_combo" t-value="line.product_type == 'combo'" />
								<t t-if="is_section">
									<t t-set="current_section" t-value="line" />
									<t t-set="current_subsection" t-value="None" />
									<t t-set="line_padding" t-value="0" />
									<t t-set="collapse_prices" t-value="line.collapse_prices" />
								</t>
								<t t-elif="is_subsection">
									<t t-set="current_subsection" t-value="line" />
									<t t-set="line_padding" t-value="2" />
									<t t-set="collapse_prices" t-value="collapse_prices or line.collapse_prices" />
								</t>
								<t t-else="">
									<t t-set="line_padding" t-value="3 if current_subsection else (2 if current_section else 0)" />
								</t>
								<t t-if="line.combo_item_id">
									<t t-set="line_padding" t-value="line_padding + 1" />
								</t>
								<t t-set="padding_class" t-value="line_padding and ('px-' + str(line_padding)) or ''" />
								<t t-if="not line.collapse_composition">
									<tr t-if="is_section or is_subsection" name="tr_section" t-att-class="'fw-bolder o_line_section' if is_section else 'fw-bold o_line_subsection'">
										<t t-set="show_section_total" t-value="is_section or not line.parent_id.collapse_prices" />
										<t t-set="section_name_colspan" t-value="3 + (1 if display_discount else 0) + (1 if display_taxes else 0)" />
										<t t-if="not show_section_total">
											<t t-set="section_name_colspan" t-value="99" />
										</t>
										<td name="td_section_name" t-att-colspan="section_name_colspan" t-att-class="padding_class">
											<span t-field="line.name">
												A section title
											</span>
										</td>
										<td t-if="show_section_total" name="td_section_price" class="text-end o_price_total">
											<span name="price_subtotal_section" t-out="line._get_section_totals(price_field)" class="text-nowrap" t-options="{'widget': 'monetary', 'display_currency': doc.currency_id}">
												27.00
											</span>
										</td>
									</tr>
									<tr t-elif="is_note" name="tr_note" class="fst-italic o_line_note">
										<td name="td_note_name" colspan="99" t-att-class="padding_class">
											<span t-field="line.name">
												A note, whose content usually applies to the section or product above.
											</span>
										</td>
									</tr>
									<tr t-elif="is_combo" name="tr_combo" class="fw-bold o_line_subsection">
										<td name="td_combo_name" t-att-colspan="3 + (1 if display_discount else 0) + (1 if display_taxes else 0)" t-att-class="padding_class">
											<span t-field="line.name">
												Combo Product
											</span>
											x
											<span t-field="line.product_uom_qty" t-options="{'widget': 'integer'}" />
										</td>
										<td name="td_combo_price" class="text-end o_price_total">
											<span t-if="not collapse_prices" name="price_subtotal_combo" t-out="line._get_combo_totals(price_field)" class="text-nowrap" t-options="{'widget': 'monetary', 'display_currency': doc.currency_id}">
												27.00
											</span>
										</td>
									</tr>
									<tr t-else="" name="tr_product">
										<td t-att-class="padding_class">
											<t t-set="index" t-value="index + 1" />
											<span t-out="index" />
										</td>
										<td name="td_product_name" t-att-class="padding_class">
											<t t-if="doc.mostrar_codigo">
												<span t-field="line.name">
												Bacon Burger
											</span>
											</t>
											<t t-else="">
												<t t-set="description" t-value="line.name"/>
												<t t-set="new_description" t-value="description[description.rfind(']') + 1:] if description.rfind(']') != -1 else description"/>
												<t t-set="formatted_description" t-value="new_description.replace('\n', '&lt;br/&gt;') if '\n' in new_description else new_description"/>
												<span t-raw="formatted_description"/>
											</t>
										</td>
										<t t-if="doc.mostrar_img_producto">
											<td name="td_img">
												<center>
													<t t-if="not line.img_ref">
														<img src="https://www.nisira.com.pe/images/Features/default-box.png" style="width: 60px; height: 60px;" />
													</t>
													<t t-else="">
														<img t-att-src="image_data_uri(line.img_ref)" style="width: 50px; height: 50px;" />
													</t>
												</center>
											</td>
										</t>
										<td name="td_product_quantity" class="o_td_quantity text-end">
											<span t-field="line.product_uom_qty" class="text-nowrap">
												3
											</span>
											<span t-field="line.product_uom_id">
												units
											</span>
											<span t-if="line.product_uom_id != line.product_id.uom_id" class="text-muted small">
												<t t-set="quantity_in_product_uom" t-value="line.product_uom_id._compute_quantity(line.product_uom_qty, line.product_id.uom_id)" />
												<br />
												<span t-esc="quantity_in_product_uom" t-options="{'widget': 'float', 'decimal_precision': 'Product Unit'}" />
												<span t-field="line.product_id.uom_id" />
											</span>
										</td>
										<td name="td_product_priceunit" class="text-end text-nowrap">
											<span t-if="not collapse_prices" t-field="line.price_unit" t-options="{'widget': 'monetary', 'display_currency': line.currency_id}">
												25.00
											</span>
										</td>
										<td t-if="doc.mostrar_descuento" name="td_product_discount" class="text-end">
											<t t-if="not collapse_prices">
												<!-- ! Always check collapse_prices separately; keep discount condition below for XPath -->
												<span t-field="line.discount">
													-
												</span>
											</t>
										</td>
										<t t-set="taxes" t-value="', '.join(tax.tax_label for tax in line.tax_ids if tax.tax_label)" />
										<td t-if="display_taxes" name="td_product_taxes" t-attf-class="text-end {{ 'text-nowrap' if len(taxes) &lt; 10 else '' }}">
											<span t-out="taxes">
												Tax 15%
											</span>
										</td>
										<td t-if="not line.is_downpayment" name="td_product_subtotal" class="text-end o_price_total">
											<t t-if="not collapse_prices">
												<span t-if="price_field == 'price_subtotal'" t-field="line.price_subtotal">
													27.00
												</span>
												<span t-else="" t-field="line.price_total">
													27.00
												</span>
											</t>
										</td>
									</tr>
								</t>
								<t t-else="">
									<!-- Displaying the section inner content, grouped by taxes -->
									<tr t-foreach="line._get_grouped_section_summary(display_taxes)" t-as="section_line" name="tr_section_group" class="o_line_section">
										<td name="td_section_group_name" t-att-class="padding_class">
											<span t-field="line.name">
												Section Summary
											</span>
										</td>
										<td name="td_section_group_quantity" class="text-end text-nowrap">
											<span>
												1.00 Units
											</span>
										</td>
										<td name="td_section_group_priceunit" class="text-end text-nowrap">
											<span name="price_subtotal_section_grouped" t-out="section_line['price_subtotal']" t-options="{'widget': 'monetary', 'display_currency': doc.currency_id}">
												25.00
											</span>
										</td>
										<td t-if="doc.mostrar_descuento" name="td_section_group_discount">
											<!-- NOTE: not computed atm, but at least provides the API for it if needed in the future -->
											<t t-set="aggregated_discount" t-value="section_line.get('discount', 0)" />
											<span t-if="aggregated_discount" t-out="aggregated_discount">
												-
											</span>
										</td>
										<td t-if="display_taxes" name="td_section_group_taxes" t-attf-class="text-end {{ 'text-nowrap' if len(section_line['tax_labels']) &lt; 10 else '' }}">
											<span t-out="', '.join(section_line['tax_labels'])">
												Tax 15%
											</span>
										</td>
										<td name="td_section_group_total" class="text-end o_price_total">
											<span t-out="section_line[price_field]" t-options="{'widget': 'monetary', 'display_currency': doc.currency_id}">
												30.00
											</span>
										</td>
									</tr>
								</t>
							</t>
						</tbody>
					</table>
					<div class="clearfix" name="so_total_summary">
						<div id="total" class="row mt-n3" name="total">
							<div t-attf-class="#{'col-6' if report_type != 'html' else 'col-sm-7 col-md-6'} ms-auto">
								<table class="o_total_table table table-borderless" style="font-size:12px;">
									<!-- Tax totals -->
									<t t-call="sale.document_tax_totals">
										<t t-set="tax_totals" t-value="doc.tax_totals" />
										<t t-set="currency" t-value="doc.currency_id" />
									</t>
								</table>
							</div>
						</div>
					</div>
					<div class="oe_structure" />
					<div t-if="not doc.signature" class="oe_structure" />
					<div t-else="" class="mt-4 ml64 mr4" name="signature">
						<div class="offset-8">
							<strong>
								Signature
							</strong>
						</div>
						<div class="offset-8">
							<img t-att-src="image_data_uri(doc.signature)" style="max-height: 4cm; max-width: 8cm;" />
						</div>
						<div class="offset-8 text-center">
							<span t-field="doc.signed_by">
								Oscar Morgan
							</span>
						</div>
					</div>
					<div>
						<span t-field="doc.note" t-attf-style="#{'text-align:justify;text-justify:inter-word;' if doc.company_id.terms_type != 'html' else ''}" name="order_note" />
						<!-- <p t-if="not is_html_empty(doc.payment_term_id.note)"> -->
						<!-- <span t-field="doc.payment_term_id.note">The payment should also be transmitted with love</span> -->
						<!-- </p> -->
						<div class="oe_structure" />
						<p t-if="doc.fiscal_position_id and not is_html_empty(doc.fiscal_position_id.sudo().note)" id="fiscal_position_remark">
							<strong>
								Fiscal Position Remark:
							</strong>
							<span t-field="doc.fiscal_position_id.sudo().note">
								No further requirements for this payment
							</span>
						</p>
					</div>
					<div class="oe_structure" />
					<t t-set="base_address" t-value="doc.env['ir.config_parameter'].sudo().get_param('web.base.url')" />
					<t t-set="portal_url" t-value="base_address + '/my/orders/' + str(doc.id) + '#portal_connect_software_modal_btn'" />
					<div t-if="any(u._is_portal() for u in doc.partner_id.user_ids) and doc._get_edi_builders()" class="text-center">
						<a t-att-href="portal_url">
							Connect your software
						</a>
						with
						<t t-out="doc.company_id.name" />
						to create quotes automatically.
					</div>
					<br />
					<table class="table table-sm o_main_table table-borderless mt-4" style="text-align:center; font-size: 11.5px;">
						<thead>
							<tr style="border-bottom: 2px solid #F8F8F8;">
								<th class="text-center">
									Entidad
								</th>
								<th class="text-center">
									Moneda
								</th>
								<th class="text-center">
									Tipo de Cuenta
								</th>
								<th class="text-center">
									Numero
								</th>
								<th class="text-center">
									CCI
								</th>
							</tr>
						</thead>
						<tbody>
							<tr style="border-bottom: 2px solid #F8F8F8;">
								<td>
									BCP
								</td>
								<td>
									Soles
								</td>
								<td>
									Corriente
								</td>
								<td>
									191-2401343-0-89
								</td>
								<td>
									00219100240134308957
								</td>
							</tr>
							<tr style="border-bottom: 2px solid #F8F8F8;">
								<td>
									BCP
								</td>
								<td>
									Dolares
								</td>
								<td>
									Corriente
								</td>
								<td>
									193-2450819-1-55
								</td>
								<td>
									00219300245081915518
								</td>
							</tr>
							<!-- <tr style="border-bottom: 2px solid #F8F8F8;"> -->
							<!-- <td>Interbank</td> -->
							<!-- <td>Soles</td> -->
							<!-- <td>Corriente</td> -->
							<!-- <td>843003376331</td> -->
							<!-- <td>308400300337633000</td> -->
							<!-- </tr> -->
							<!-- <tr style="border-bottom: 2px solid #F8F8F8;"> -->
							<!-- <td>Interbank</td> -->
							<!-- <td>Dolares</td> -->
							<!-- <td>Corriente</td> -->
							<!-- <td>843003376349</td> -->
							<!-- <td>308400300337634000</td> -->
							<!-- </tr> -->
							<tr style="border-bottom: 2px solid #F8F8F8;">
								<td>
									Nacion
								</td>
								<td>
									Soles
								</td>
								<td>
									Detracciones
								</td>
								<td>
									00-085-025643
								</td>
								<td>
									01808500008502564319
								</td>
							</tr>
							<tr style="border-bottom: 2px solid #F8F8F8;">
								<td>
									Yape
								</td>
								<td>
									Soles
								</td>
								<td>
									-
								</td>
								<td>
									981 094 754
								</td>
								<td>
									-
								</td>
							</tr>
						</tbody>
					</table>
					<div style="margin-top: 25px;">
						<table style="width: 100%; text-align: center; border:0px !important;backgrount-color:white !important;">
							<tbody style="border:0px !important;">
								<tr style="border:0px !important;">
									<td style="width: 20%;border:0px !important;">
										<img width="120px" src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ce/K%C3%A4rcher_Logo_2015.svg/800px-K%C3%A4rcher_Logo_2015.svg.png" alt="" />
									</td>
									<td style="width: 20%;border:0px !important;">
										<img width="120px" src="https://storagecompat.com.uy/sites/default/files/logo_0.png" alt="" />
									</td>
									<td style="width: 20%;border:0px !important;">
										<img width="120px" src="https://cdn.cookielaw.org/logos/214cc03f-7b8e-4583-a7e7-0339b52694d8/dd84aee9-603a-47d4-89d7-ed9c468188df/72196acc-3b85-4dee-97ed-15803f846200/cp_privacy_policy_logo.png" alt="" />
									</td>
									<td style="width: 20%;border:0px !important;">
										<img width="80px" src="https://logodix.com/logo/628125.png" alt="" />
									</td>
									<td style="width: 20%;border:0px !important;">
										<img width="80px" src="https://ajm.es/wp-content/uploads/2017/06/samoa-logo-2017.png" alt="" />
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</t>
		</xpath>
	</template>
</odoo>
